<div class="warehouse-form-container container-fluid py-4">
  <div *ngIf="loading" class="d-flex justify-content-center align-items-center py-5">
    <app-loading-spinner></app-loading-spinner>
  </div>

  <div *ngIf="!loading" class="form-content max-width-1000 mx-auto">
    <div class="d-flex justify-content-start mb-4">
      <app-unified-button
        variant="secondary"
        [outlined]="true"
        size="sm"
        (clicked)="router.navigate(['/warehouses'])"
        icon="bi-arrow-left"
        iconLibrary="bi">
        Back to Warehouses
      </app-unified-button>
    </div>

    <div class="row g-4">
      <!-- Basic Information -->
      <div class="col-lg-7">
        <app-unified-card header="Basic Information" customClass="mb-4 border-0 shadow-sm">
          <div class="row g-3">
            <div class="col-md-8">
              <app-form-field label="Warehouse Name" type="text" [(ngModel)]="formData.name" [required]="true"></app-form-field>
            </div>
            <div class="col-md-4">
              <app-form-field label="Code" type="text" [(ngModel)]="formData.code" placeholder="Optional"></app-form-field>
            </div>
            <div class="col-12">
              <app-form-field label="Description" type="textarea" [(ngModel)]="formData.description" [rows]="3"></app-form-field>
            </div>
            <div class="col-12 mt-2">
              <app-unified-checkbox label="Set as Default Warehouse" [(ngModel)]="formData.isDefault"></app-unified-checkbox>
            </div>
          </div>
        </app-unified-card>

        <app-unified-card header="Address Information" customClass="border-0 shadow-sm">
          <div class="row g-3">
            <div class="col-12">
              <app-form-field label="Street Address" type="text" [(ngModel)]="formData.address"></app-form-field>
            </div>
            <div class="col-md-6">
              <app-form-field label="City" type="text" [(ngModel)]="formData.city"></app-form-field>
            </div>
            <div class="col-md-6">
              <app-form-field label="State / Province" type="text" [(ngModel)]="formData.state"></app-form-field>
            </div>
            <div class="col-md-6">
              <app-form-field label="Country" type="text" [(ngModel)]="formData.country"></app-form-field>
            </div>
            <div class="col-md-6">
              <app-form-field label="Postal Code" type="text" [(ngModel)]="formData.postalCode"></app-form-field>
            </div>
          </div>
        </app-unified-card>
      </div>

      <!-- Contact Information -->
      <div class="col-lg-5">
        <app-unified-card header="Contact Information" customClass="border-0 shadow-sm">
          <div class="row g-3">
            <div class="col-12">
              <app-form-field label="Phone Number" type="tel" [(ngModel)]="formData.phoneNumber" icon="bi-telephone" iconLibrary="bi"></app-form-field>
            </div>
            <div class="col-12">
              <app-form-field label="Email Address" type="email" [(ngModel)]="formData.email" icon="bi-envelope" iconLibrary="bi"></app-form-field>
            </div>
          </div>
        </app-unified-card>
      </div>
    </div>

    <div class="d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
      <app-unified-button
        variant="secondary"
        [outlined]="true"
        (clicked)="router.navigate(['/warehouses'])">
        Cancel
      </app-unified-button>
      
      <app-unified-button
        variant="primary"
        *appHasPermission="isEditMode ? 'Warehouses:Update' : 'Warehouses:Create'"
        (clicked)="save()"
        [loading]="saving"
        icon="bi-save"
        iconLibrary="bi">
        {{ isEditMode ? 'Update' : 'Create' }} Warehouse
      </app-unified-button>
    </div>
  </div>

  <app-toast
    *ngIf="showToast"
    [message]="toastMessage"
    [type]="toastType"
    (close)="showToast = false">
  </app-toast>
</div>
