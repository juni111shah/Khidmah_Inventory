<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <a routerLink="/reorder/list" class="btn btn-outline-secondary btn-sm"><i class="bi bi-arrow-left me-1"></i> Back</a>
  </div>

  <app-toast *ngIf="showToast" [message]="toastMessage" [type]="toastType" (close)="showToast = false"></app-toast>

  <app-content-loader [loading]="loading">
    <ng-container skeleton>
      <app-skeleton-detail-header [actionCount]="0" class="mb-4"></app-skeleton-detail-header>
      <app-unified-card header="" customClass="mb-4 border-0 shadow-sm">
        <app-skeleton-form [fieldCount]="3" [showLabels]="true" [showActions]="false"></app-skeleton-form>
      </app-unified-card>
      <app-unified-card header="" customClass="border-0 shadow-sm">
        <app-skeleton-table [rows]="5" [columns]="4" [showHeader]="true"></app-skeleton-table>
      </app-unified-card>
    </ng-container>
    <ng-container *ngIf="!loading">
    <div *ngIf="suggestions.length === 0" class="alert alert-info">No items selected. <a routerLink="/reorder/list">Select from list</a></div>

    <app-unified-card *ngIf="suggestions.length > 0" header="Order details" customClass="mb-4 border-0 shadow-sm">
      <form [formGroup]="form">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Supplier <span class="text-danger">*</span></label>
            <select class="form-select" formControlName="supplierId">
              <option value="">Select supplier</option>
              <option *ngFor="let s of suppliers" [value]="s.id">{{ s.name }}</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Expected delivery</label>
            <input type="date" class="form-control" formControlName="expectedDeliveryDate" />
          </div>
          <div class="col-md-4">
            <label class="form-label">Notes</label>
            <input type="text" class="form-control" formControlName="notes" placeholder="Optional" />
          </div>
        </div>
      </form>
    </app-unified-card>

    <app-unified-card *ngIf="suggestions.length > 0" header="Lines ({{ suggestions.length }})" customClass="mb-4 border-0 shadow-sm">
      <app-data-table
        [columns]="lineColumns"
        [data]="suggestions"
        [loading]="false"
        [config]="lineTableConfig">
      </app-data-table>
      <div class="mt-3">
        <app-unified-button variant="primary" (clicked)="generatePO()" [disabled]="saving">
          {{ saving ? 'Creatingâ€¦' : 'Create purchase order' }}
        </app-unified-button>
      </div>
    </app-unified-card>
  </ng-container>
  </app-content-loader>
</div>
