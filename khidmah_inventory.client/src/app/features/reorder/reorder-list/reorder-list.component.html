<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <a routerLink="/reorder" class="btn btn-outline-secondary btn-sm"><i class="bi bi-speedometer2 me-1"></i> Dashboard</a>
  </div>

  <app-toast *ngIf="showToast" [message]="toastMessage" [type]="toastType" (closed)="showToast = false"></app-toast>

  <app-unified-card customClass="mb-4 border-0 shadow-sm">
    <div class="row g-3">
      <div class="col-md-3">
        <label class="form-label small text-muted">Warehouse</label>
        <select class="form-select form-select-sm" [value]="selectedWarehouseId ?? ''" (change)="selectedWarehouseId = $any($event.target).value || null">
          <option value="">All</option>
          <option *ngFor="let w of warehouses" [value]="w.id">{{ w.name }}</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label small text-muted">Priority</label>
        <select class="form-select form-select-sm" [value]="selectedPriority ?? ''" (change)="selectedPriority = $any($event.target).value || null">
          <option value="">All</option>
          <option value="Critical">Critical</option>
          <option value="High">High</option>
          <option value="Medium">Medium</option>
          <option value="Low">Low</option>
        </select>
      </div>
      <div class="col-md-2 d-flex align-items-end">
        <button class="btn btn-primary btn-sm" (click)="applyFilters()">Apply</button>
      </div>
    </div>
  </app-unified-card>

  <app-content-loader [loading]="loading">
    <ng-container skeleton>
      <app-unified-card customClass="mb-4 border-0 shadow-sm">
        <app-skeleton-form [fieldCount]="3" [showLabels]="true" [showActions]="true"></app-skeleton-form>
      </app-unified-card>
      <app-unified-card header="" customClass="border-0 shadow-sm">
        <app-skeleton-table [rows]="10" [columns]="9" [showHeader]="true"></app-skeleton-table>
      </app-unified-card>
    </ng-container>
    <app-unified-card *ngIf="!loading" customClass="border-0 shadow-sm">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">{{ pagedResult?.totalCount ?? suggestions.length }} item(s)</span>
        <a *ngIf="selectedSuggestions.length > 0" [routerLink]="['/reorder/generate-po']" [queryParams]="{ ids: getSelectedIdsParam() }" class="btn btn-success btn-sm">
          <i class="bi bi-cart-plus me-1"></i> Generate PO ({{ selectedSuggestions.length }})
        </a>
      </div>
      <app-data-table
        [columns]="columns"
        [data]="pagedResult?.items ?? []"
        [loading]="loading"
        [config]="config"
        [actions]="actions"
        [pagedResult]="pagedResult"
        [filterRequest]="filterRequest"
        (filterChange)="onFilterChange($event)"
        (pageChange)="onPageChange($event)"
        (sortChange)="onSortChange($event)"
        (rowSelect)="selectedSuggestions = $event">
      </app-data-table>
    </app-unified-card>
  </app-content-loader>
</div>
